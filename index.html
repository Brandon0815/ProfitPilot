<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProfitPilot - AI-Powered Dropshipping Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            font-weight: bold;
        }

        .logo h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tagline {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            font-weight: 300;
        }

        .nav {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .nav-btn:hover, .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .metric {
            text-align: center;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #333;
            margin-bottom: 10px;
        }

        .metric-label {
            color: #666;
            font-size: 1rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .profit { color: #22c55e; }
        .margin { color: #3b82f6; }
        .revenue { color: #f59e0b; }
        .products { color: #8b5cf6; }

        .upload-area {
            border: 3px dashed rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 60px 20px;
            text-align: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 30px;
        }

        .upload-area:hover, .upload-area.dragover {
            border-color: #ff6b6b;
            background: rgba(255, 107, 107, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            opacity: 0.7;
        }

        .upload-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .upload-subtext {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }

        .table-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            overflow: hidden;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 0.9rem;
        }

        tr:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .ai-panel {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.3);
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ai-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .ai-suggestions {
            display: grid;
            gap: 15px;
        }

        .ai-suggestion {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid #ff6b6b;
        }

        .hidden {
            display: none;
        }

        .btn-primary {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            border: none;
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(255, 107, 107, 0.4);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .status-message {
            padding: 15px 20px;
            border-radius: 12px;
            margin: 20px 0;
            font-weight: 500;
        }

        .success {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .error {
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .logo h1 {
                font-size: 2rem;
            }
            
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">PP</div>
                <div>
                    <h1>ProfitPilot</h1>
                    <div class="tagline">AI-Powered Dropshipping Profit Tracker</div>
                </div>
            </div>
            
            <div class="nav">
                <button class="nav-btn active" onclick="showSection('dashboard')">üìä Dashboard</button>
                <button class="nav-btn" onclick="showSection('upload')">üìÅ Import Data</button>
                <button class="nav-btn" onclick="showSection('products')">üì¶ Products</button>
                <button class="nav-btn" onclick="showSection('ai-insights')">ü§ñ AI Insights</button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="section">
            <div class="dashboard">
                <div class="card">
                    <div class="metric">
                        <div class="metric-value profit" id="total-profit">$0.00</div>
                        <div class="metric-label">Total Net Profit</div>
                    </div>
                </div>
                <div class="card">
                    <div class="metric">
                        <div class="metric-value margin" id="avg-margin">0%</div>
                        <div class="metric-label">Average Margin</div>
                    </div>
                </div>
                <div class="card">
                    <div class="metric">
                        <div class="metric-value revenue" id="total-revenue">$0.00</div>
                        <div class="metric-label">Total Revenue</div>
                    </div>
                </div>
                <div class="card">
                    <div class="metric">
                        <div class="metric-value products" id="product-count">0</div>
                        <div class="metric-label">Products Tracked</div>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="margin-bottom: 20px; color: #333; font-size: 1.5rem;">Profit Over Time</h3>
                <canvas id="profitChart" width="400" height="150"></canvas>
            </div>
        </div>

        <!-- Upload Section -->
        <div id="upload-section" class="section hidden">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">üìä</div>
                <div class="upload-text">Drop your CSV file here or click to browse</div>
                <div class="upload-subtext">Support for invoice files with Amount, Fees, and Net columns</div>
                <input type="file" id="csvFile" accept=".csv" style="display: none;">
            </div>
            <div id="upload-status"></div>
        </div>

        <!-- Products Section -->
        <div id="products-section" class="section hidden">
            <div class="table-container">
                <h3 style="margin-bottom: 20px; color: #333; font-size: 1.5rem;">Product Performance</h3>
                <table id="productsTable">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Revenue</th>
                            <th>Costs</th>
                            <th>Net Profit</th>
                            <th>Margin %</th>
                            <th>Orders</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <tr>
                            <td colspan="6" style="text-align: center; color: #666; padding: 40px;">
                                No products imported yet. Upload a CSV file to get started!
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- AI Insights Section -->
        <div id="ai-insights-section" class="section hidden">
            <div class="ai-panel">
                <div class="ai-header">
                    <div class="ai-icon">ü§ñ</div>
                    <div>
                        <h3>AI-Powered Insights</h3>
                        <p style="opacity: 0.8; margin-top: 5px;">Smart recommendations to boost your profits</p>
                    </div>
                    <button class="btn-primary" onclick="generateAIInsights()" style="margin-left: auto;">
                        Generate Insights
                    </button>
                </div>
                
                <div class="ai-suggestions" id="aiSuggestions">
                    <div class="ai-suggestion">
                        <h4>üí° Upload Data First</h4>
                        <p>Import your CSV data to unlock AI-powered insights and recommendations tailored to your dropshipping business.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global data store
        let appData = {
            products: [],
            orders: [],
            metrics: {
                totalProfit: 0,
                totalRevenue: 0,
                avgMargin: 0,
                productCount: 0
            }
        };

        let profitChart = null;

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');
            
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // File Upload Setup
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.getElementById('uploadArea');
            const csvFile = document.getElementById('csvFile');
            
            uploadArea.addEventListener('click', () => csvFile.click());
            
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    handleFile(files[0]);
                }
            });
            
            csvFile.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFile(e.target.files[0]);
                }
            });
            
            initChart();
        });

        // File Processing
        function handleFile(file) {
            const statusDiv = document.getElementById('upload-status');
            
            if (!file.name.toLowerCase().endsWith('.csv')) {
                showStatus('Please upload a CSV file', 'error');
                return;
            }
            
            showStatus('Processing file...', 'info');
            
            Papa.parse(file, {
                header: true,
                skipEmptyLines: true,
                complete: function(results) {
                    processCSVData(results.data);
                },
                error: function(error) {
                    showStatus('Error parsing CSV: ' + error.message, 'error');
                }
            });
        }

        function processCSVData(data) {
            try {
                appData.products = [];
                appData.orders = [];
                
                data.forEach((row, index) => {
                    // Generate sample product data based on CSV
                    const productName = row.Description || row.Product || `Product ${index + 1}`;
                    const revenue = parseFloat(row.Amount || row.Revenue || (Math.random() * 200 + 50).toFixed(2));
                    const fees = parseFloat(row.Fees || row['Fees & Taxes'] || (revenue * 0.1).toFixed(2));
                    const netProfit = parseFloat(row.Net || (revenue - fees).toFixed(2));
                    const costs = revenue - netProfit;
                    const margin = revenue > 0 ? ((netProfit / revenue) * 100).toFixed(1) : 0;
                    
                    const product = {
                        id: index + 1,
                        name: productName,
                        revenue: revenue,
                        costs: costs,
                        netProfit: netProfit,
                        margin: parseFloat(margin),
                        orders: Math.floor(Math.random() * 20) + 1
                    };
                    
                    appData.products.push(product);
                    
                    // Create order data for charting
                    const orderDate = new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000);
                    appData.orders.push({
                        date: orderDate,
                        profit: netProfit,
                        product: productName
                    });
                });
                
                calculateMetrics();
                updateDashboard();
                updateProductsTable();
                updateChart();
                
                showStatus(`Successfully processed ${data.length} records!`, 'success');
                
                // Auto-switch to dashboard
                setTimeout(() => {
                    showSection('dashboard');
                    document.querySelector('[onclick="showSection(\'dashboard\')"]').classList.add('active');
                }, 1500);
                
            } catch (error) {
                showStatus('Error processing data: ' + error.message, 'error');
            }
        }

        function calculateMetrics() {
            appData.metrics.totalProfit = appData.products.reduce((sum, p) => sum + p.netProfit, 0);
            appData.metrics.totalRevenue = appData.products.reduce((sum, p) => sum + p.revenue, 0);
            appData.metrics.avgMargin = appData.products.length > 0 
                ? appData.products.reduce((sum, p) => sum + p.margin, 0) / appData.products.length 
                : 0;
            appData.metrics.productCount = appData.products.length;
        }

        function updateDashboard() {
            document.getElementById('total-profit').textContent = '$' + appData.metrics.totalProfit.toFixed(2);
            document.getElementById('avg-margin').textContent = appData.metrics.avgMargin.toFixed(1) + '%';
            document.getElementById('total-revenue').textContent = '$' + appData.metrics.totalRevenue.toFixed(2);
            document.getElementById('product-count').textContent = appData.metrics.productCount;
        }

        function updateProductsTable() {
            const tbody = document.getElementById('productsTableBody');
            tbody.innerHTML = '';
            
            appData.products.forEach(product => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${product.name}</strong></td>
                    <td>$${product.revenue.toFixed(2)}</td>
                    <td>$${product.costs.toFixed(2)}</td>
                    <td class="profit">$${product.netProfit.toFixed(2)}</td>
                    <td>${product.margin.toFixed(1)}%</td>
                    <td>${product.orders}</td>
                `;
                tbody.appendChild(row);
            });
        }

        function initChart() {
            const ctx = document.getElementById('profitChart').getContext('2d');
            profitChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Daily Profit',
                        data: [],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '$' + value.toFixed(0);
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateChart() {
            if (!profitChart) return;
            
            // Group orders by date
            const profitByDate = {};
            appData.orders.forEach(order => {
                const dateKey = order.date.toDateString();
                if (!profitByDate[dateKey]) {
                    profitByDate[dateKey] = 0;
                }
                profitByDate[dateKey] += order.profit;
            });
            
            const sortedDates = Object.keys(profitByDate).sort((a, b) => new Date(a) - new Date(b));
            const labels = sortedDates.map(date => new Date(date).toLocaleDateString());
            const data = sortedDates.map(date => profitByDate[date]);
            
            profitChart.data.labels = labels;
            profitChart.data.datasets[0].data = data;
            profitChart.update();
        }

        function generateAIInsights() {
            const suggestionsDiv = document.getElementById('aiSuggestions');
            
            if (appData.products.length === 0) {
                showStatus('Please upload data first to generate AI insights', 'error');
                return;
            }
            
            // Show loading
            suggestionsDiv.innerHTML = '<div style="text-align: center; padding: 40px;"><div class="loading"></div></div>';
            
            // Simulate AI processing
            setTimeout(() => {
                const insights = generateSmartInsights();
                displayAIInsights(insights);
            }, 2000);
        }

        function generateSmartInsights() {
            const products = appData.products;
            const insights = [];
            
            // Find best/worst performers
            const bestProduct = products.reduce((max, p) => p.netProfit > max.netProfit ? p : max);
            const worstProduct = products.reduce((min, p) => p.netProfit < min.netProfit ? p : min);
            
            insights.push({
                title: "üèÜ Top Performer",
                content: `${bestProduct.name} is your most profitable product with $${bestProduct.netProfit.toFixed(2)} net profit and ${bestProduct.margin.toFixed(1)}% margin. Consider increasing marketing spend on this item.`
            });
            
            if (worstProduct.netProfit < 0) {
                insights.push({
                    title: "‚ö†Ô∏è Loss Alert",
                    content: `${worstProduct.name} is losing money with -$${Math.abs(worstProduct.netProfit).toFixed(2)} net profit. Review pricing or find a new supplier.`
                });
            }
            
            // Margin analysis
            const lowMarginProducts = products.filter(p => p.margin < 20);
            if (lowMarginProducts.length > 0) {
                insights.push({
                    title: "üìà Margin Optimization",
                    content: `${lowMarginProducts.length} products have margins below 20%. Consider negotiating better supplier rates or adjusting prices.`
                });
            }
            
            // Revenue concentration
            const totalRevenue = appData.metrics.totalRevenue;
            const topProducts = products.sort((a, b) => b.revenue - a.revenue).slice(0, 3);
            const topThreeRevenue = topProducts.reduce((sum, p) => sum + p.revenue, 0);
            
            if (topThreeRevenue / totalRevenue > 0.7) {
                insights.push({
                    title: "üéØ Diversification Tip",
                    content: `Your top 3 products generate ${((topThreeRevenue/totalRevenue)*100).toFixed(0)}% of revenue. Consider diversifying your product portfolio to reduce risk.`
                });
            }
            
            return insights;
        }

        function displayAIInsights(insights) {
            const suggestionsDiv = document.getElementById('aiSuggestions');
            suggestionsDiv.innerHTML = '';
            
            insights.forEach(insight => {
                const suggestionEl = document.createElement('div');
                suggestionEl.className = 'ai-suggestion';
                suggestionEl.innerHTML = `
                    <h4>${insight.title}</h4>
                    <p>${insight.content}</p>
                `;
                suggestionsDiv.appendChild(suggestionEl);
            });
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('upload-status');
            statusDiv.innerHTML = `<div class="status-message ${type}">${message}</div>`;
            
            if (type === 'success') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }
    </script>
</body>
</html>


